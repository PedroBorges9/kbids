<Ontology name="Default" version="0" elementTimeout="PT10M">
	<Primitives>
		<!-- 
		<Primitive name="WiFi_TX_Packets" minE="0" maxE="*" /> 
		<Primitive name="Outgoing_SMS" minE="0" maxE="*" />	 
		<Primitive name="Context_Switches" minE="0" maxE="*" />
		<Primitive name="Camera" minE="0" maxE="*" />
		<Primitive name="Avg_Touch_Pressure" minE="0" maxE="*" />
		<Primitive name="Avg_Key_Dwell_Time" minE="0" maxE="*" />	
		<Primitive name="Perm_Camera" minE="0" maxE="*" />
		<Primitive name="Perm_S-SMS_R-Contacts" minE="0" maxE="*" />
		-->
	
		<Primitive name="CPU_Usage" minE="0" maxE="100" />
		<Primitive name="Runnable_Entities" minE="0" maxE="*" />
	</Primitives>
	

	<Events>
		<Event name="Package_Addition" /> 
		<Event name="Activity_Start" /> 
		<Event name="USB_Connection" />
		<Event name="USB_Disconnection" />
		<Event name="SDCard_Access" />
	</Events>

	<!-- 
		Assumptions:
		1. Contexts start at the same time as the inducing element
	 -->
	<Contexts>	
		<Context name="Post_Application_Run">
			<Inductions>
				<Induction>
					<Event name="Activity_Start" />
					<Ends relativeTo="end" gap="PT5M" />
				</Induction>
			</Inductions>

			<Destructions />
		</Context>
		
<!-- 
		<Context name="Access_to_SDCard">
			<Inductions>
				<Induction>
					<Event name="SDCard_Access" />
					<Ends relativeTo="end" gap="PT15S" />
				</Induction>
			</Inductions>

			<Destructions />
		</Context>
		
		<Context name="Connected_to_USB">
			<Inductions>
				<Induction>
					<Event name="USB_Connection" />
					<Ends relativeTo="start" gap="*" />
				</Induction>
			</Inductions>

			<Destructions>
				<Event name="USB_Disconnection" />
			</Destructions>
		</Context>
		
		<Context name="Non_System_Apps_With_Camera_Perm_Exist">
			<Inductions>
				<Induction>
					<Primitive name="Perm_Camera" minE="1" maxE="*" />
					<Ends relativeTo="end" gap="PT5S" />
				</Induction>
			</Inductions>

			<Destructions>
				<Primitive name="Perm_Camera" minE="0" maxE="0" />
			</Destructions>
		</Context>
		
		<Context name="Non_System_Apps_With_S-Sms_R-Contacts_Perm_Added">
			<Inductions>
				<Induction>
					<Trend name="Perm_S-SMS_R-Contacts_Trend" value="Increasing" />
					<Ends relativeTo="end" gap="PT5M" />
				</Induction>
			</Inductions>

			<Destructions />
		</Context>
		 -->
	</Contexts>

	<States>
	
		<State name="CPU_Usage_State">
			<AbstractedFrom>
				<Primitive name="CPU_Usage" />
			</AbstractedFrom>
			<NecessaryContexts>
				<Context name="Post_Application_Run" />
			</NecessaryContexts>
			<MappingFunction>
				<Value name="Normal">
					<Primitive name="CPU_Usage" minE="0" maxE="50" />
				</Value>
				<Value name="High">
					<Primitive name="CPU_Usage" min="50" maxE="*" />
				</Value>
			</MappingFunction>
			<InterpolationFunction>
				<Value name="Normal" maxGap="PT1H" />
				<Value name="High" maxGap="PT1H" />
			</InterpolationFunction>
		</State>
	<!-- 
		<State name="Context_Switches">
			<AbstractedFrom>
				<Primitive name="Context_Switches" />
			</AbstractedFrom>
			<NecessaryContexts>
				<Context name="Post_Application_Run" />
			</NecessaryContexts>
			<MappingFunction>
				<Value name="Normal">
					<Primitive name="Context_Switches" minE="0" maxE="TODO" />
				</Value>
				<Value name="High">
					<Primitive name="Context_Switches" minE="TODO" maxE="*" />
				</Value>
			</MappingFunction>
			<InterpolationFunction>
				<Value name="Normal" maxGap="PT1H" />
				<Value name="High" maxGap="PT1H" />
			</InterpolationFunction>
		</State>
		
		<State name="System_Load_level">
			<AbstractedFrom>
				<State name="Context_Switches" />
				<State name="CPU_Usage" />
				<Trend name="Garbage_Collections" />
			</AbstractedFrom>
			<NecessaryContexts>
				<Context name="High_CPU_Usage" />
			</NecessaryContexts>
			<MappingFunction>
				<Value name="Normal">
					<State name="Context_Switches" value="Normal" />
					<State name="CPU_Usage"	value="Normal" />
					<Trend name="Garbage_Collections" value="Same" />
				</Value>
				<Value name="Normal">
					<State name="Context_Switches" value="Normal" />
					<State name="CPU_Usage"	value="Normal" />
					<Trend name="Garbage_Collections" value="Decreasing" />
				</Value>
				<Value name="High">
					<State name="Context_Switches" value="High" />
					<State name="CPU_Usage"	value="High" />
					<Trend name="Garbage_Collections" value="High" />
				</Value>
			</MappingFunction>
			<InterpolationFunction>
				<Value name="Normal" maxGap="PT1H" />
				<Value name="High" maxGap="PT1H" />
			</InterpolationFunction>
		</State>
		
		<State name="User Activity">
			<AbstractedFrom>
				<Primitive name="Avg_Touch_Pressure" />
				<Primitive name="Avg_Key_Dwell_Time" />
			</AbstractedFrom>
			<NecessaryContexts /> 
			<MappingFunction>
				<Value name="Activity">
					<Primitive name="Avg_Touch_Pressure" min="0" maxE="*" />
					<Primitive name="Avg_Key_Dwell_Time" minE="0" maxE="*" />
				</Value>
				<Value name="Activity">
					<Primitive name="Avg_Touch_Pressure" minE="0" maxE="*" />
					<Primitive name="Avg_Key_Dwell_Time" min="0" maxE="*" />
				</Value>
				<Value name="No_Activity">
					<Primitive name="Avg_Touch_Pressure" minE="0" maxE="0" />
					<Primitive name="Avg_Key_Dwell_Time" minE="0" maxE="0" />
				</Value>
			</MappingFunction>
			<InterpolationFunction>
				<Value name="Activity" maxGap="PT1H" />
				<Value name="No_Activity" maxGap="PT1H" />
			</InterpolationFunction>
		</State>
		 -->
	</States>
	
	<!-- 
		Assumptions: 
		1. the threshold is the change rate of the value of the primitive per second
		2. the angle is in degrees and not radians 
		3. trends are created from primitives (and a single primitive at that)
	-->
	<Trends>
		
		<Trend name="Runnable_Entities_Trend">
			<AbstractedFrom name="Runnable_Entities" />
			<NecessaryContexts>
				<Context name="Post_Application_Run" />
			</NecessaryContexts>
			<MappingFunction threshold="0" angle="45" maxGap="PT1H" /> 
		</Trend>
		<!-- 
		
		<Trend name="Perm_S-SMS_R-Contacts_Trend">
			<AbstractedFrom name="Perm_S-SMS_R-Contacts" />
			<NecessaryContexts>
			</NecessaryContexts>
			<MappingFunction threshold="0.5" angle="0.01" maxGap="PT1H" /> 
		</Trend>
		
		<Trend name="Sent_Packets_Trend">
			<AbstractedFrom name="WiFi_TX_Packets" />
			<NecessaryContexts>
				<Context name="Access_to_SDCard" />
			</NecessaryContexts>
			<MappingFunction threshold="0.35" angle="45" maxGap="PT1H" /> 
		</Trend>
				
		<Trend name="Pictures_Taken">
			<AbstractedFrom name="Camera" />
			<NecessaryContexts>
				<Context name="Non_System_Apps_With_Camera_Perm_Exist" />
			</NecessaryContexts>
			<MappingFunction threshold="TODO" angle="TODO" maxGap="PT1H" /> 
		</Trend>
		
		<Trend name="Outgoing_SMS">
			<AbstractedFrom name="Outgoing_SMS" />
			<NecessaryContexts>
				<Context name="Non_System_Apps_With_S-Sms_R-Contacts_Perm_Added" />
			</NecessaryContexts>
			<MappingFunction threshold="TODO" angle="TODO" maxGap="PT1H" /> 
		</Trend>
		 -->
	</Trends>
	
	<!-- 
		assumptions:
		1. the ordinal must be sequential starting with 0
	
	 -->
	<Patterns>
		<LinearPattern name="DDoS Attack">
			<Elements>
	<!--			<Primitive name="CPU_Usage" ordinal="1">
					<NumericValueConditon minE="31" maxE="100" />
					<DurationCondition min="PT0S" max="P8D" />
				</Primitive> -->
				<State name="Garbage_Collections_Level" ordinal="0"> <!-- can be Trend -->
					<SymbolicValueCondition>
						<Value name="High" />
					</SymbolicValueCondition>
					<DurationCondition min="PT1S" max="P8D" />
				</State>
				<Context name="High_CPU_Usage" ordinal="1"> <!-- can be context -->
					<DurationCondition min="PT3S" max="P8D" />
				</Context>
				<Primitive name="CPU_Usage" ordinal="2">
					<NumericValueConditon minE="31" maxE="100" />
					<DurationCondition min="PT0S" max="P8D" />
				</Primitive>
				
				
			</Elements>
			<PairWiseConditions>
			<!--	<PairWiseCondition first="2" second="0" value="*" 
					temporal="Overlap" minLength="PT00S" maxLength="PT30S" minStartingDistance="PT1S" maxStartingDistance="PT30S"/> -->
				<PairWiseCondition first="1" second="0" value="*" 
					temporal="Before" minGap="PT1S" maxGap="PT30S" />  
			</PairWiseConditions>
		</LinearPattern>
	</Patterns>
</Ontology>
