<Ontology name="Default" version="0" elementTimeout="PT10M">
	<Primitives>
		<Primitive name="CPU_Usage" minE="0" maxE="100" />
		<Primitive name="Garbage_Collections" minE="0" maxE="*" />
		<Primitive name="Running_Processes" minE="0" maxE="*" />
		<Primitive name="Minor_Page_Faults" minE="0" maxE="*" />
		<Primitive name="Context_Switches" minE="0" maxE="*" />
		<Primitive name="Camera" minE="0" maxE="*" />
		<Primitive name="Perm_Camera" minE="0" maxE="*" />
		<Primitive name="WiFi_TX_Bytes" minE="0" maxE="*" />
		
		
	</Primitives>

	<Events>
		<Event name="WiFi_Connection" />
		<Event name="Picture_Taken" />
		<Event name="Keyboard_Opening" />
		<Event name="Keyboard_Closing" />
	</Events>

	<Contexts>
		<Context name="Keyboard_Open">
			<Inductions>
				<Induction>
					<Event name="Keyboard_Opening" />

					<Ends relativeTo="end" gap="PT1M" />

				</Induction>
				<Induction>
					<Trend name="CPU_Usage_Change" value="Rising" />

					<Ends relativeTo="end" gap="PT1M" />
				</Induction>
			</Inductions>

			<Destructions></Destructions>
		</Context>

		<Context name="High_CPU_Usage">
			<Inductions>
				<Induction>
					<Primitive name="CPU_Usage" min="80" maxE="100" />

					<Ends relativeTo="end" gap="PT20S" />
				</Induction>
			</Inductions>

			<Destructions>
				<Primitive name="CPU_Usage" min="20" maxE="60" />
			</Destructions>
		</Context>

		<Context name="Amount_of_Processes_High">
			<Inductions>
				<Induction>
					<Primitive name="Running_Processes" min="30"
						maxE="*" />
					<Ends relativeTo="end" gap="PT5S" />
				</Induction>
			</Inductions>

			<Destructions></Destructions>
		</Context>
		
		<Context name="Many_Apps_With_Camera_Permission">
			<Inductions>
				<Induction>
					<Primitive name="Perm_Camera" minE="1"
						maxE="*" />
					<Ends relativeTo="end" gap="PT5S" />
				</Induction>
			</Inductions>

			<Destructions></Destructions>
		</Context>
		
		<Context name="Connected_To_WiFi">
			<Inductions>
				<Induction>
					<Event name="WiFi_Connection" />
					<Ends relativeTo="end" gap="PT5S" />
				</Induction>
			</Inductions>

			<Destructions></Destructions>
		</Context>
	</Contexts>

	<States>
		<State name="Garbage_Collections_Level">
			<AbstractedFrom>
				<Primitive name="Garbage_Collections" />
			</AbstractedFrom>
			<NecessaryContexts>
				<Context name="High_CPU_Usage" />
			</NecessaryContexts>
			<MappingFunction>
				<Value name="Low">
					<Primitive name="Garbage_Collections" minE="0"
						maxE="30" />
				</Value>
				<Value name="Normal">
					<Primitive name="Garbage_Collections" minE="31"
						maxE="100" />
				</Value>
				<Value name="High">
					<Primitive name="Garbage_Collections" minE="101"
						maxE="*" />
				</Value>
			</MappingFunction>
			<InterpolationFunction>
				<Value name="Low" maxGap="PT1M" />
				<Value name="Normal" maxGap="P30S" />
				<Value name="High" maxGap="P10S" />
			</InterpolationFunction>
		</State>

		<State name="Minor_Page_Faults_Level">
			<AbstractedFrom>
				<Primitive name="Minor_Page_Faults" />
			</AbstractedFrom>
			<NecessaryContexts>
				<Context name="Amount_of_Processes_High" />
			</NecessaryContexts>
			<MappingFunction>
				<Value name="Low">
					<Primitive name="Minor_Page_Faults" minE="0"
						maxE="100" />
				</Value>
				<Value name="Normal">
					<Primitive name="Minor_Page_Faults" minE="101"
						maxE="300" />
				</Value>
				<Value name="High">
					<Primitive name="Minor_Page_Faults" minE="301"
						maxE="*" />
				</Value>
			</MappingFunction>
			<InterpolationFunction>
				<Value name="Low" maxGap="PT1M" />
				<Value name="Normal" maxGap="P30S" />
				<Value name="High" maxGap="P10S" />
			</InterpolationFunction>
		</State>

		<State name="Context_Switches_Level">
			<AbstractedFrom>
				<Primitive name="Context_Switches" />
			</AbstractedFrom>
			<NecessaryContexts>
				<Context name="Amount_of_Processes_High" />
			</NecessaryContexts>
			<MappingFunction>
				<Value name="Low">
					<Primitive name="Context_Switches" minE="0"	maxE="200" />
				</Value>
				<Value name="Normal">
					<Primitive name="Context_Switches" minE="201"
						maxE="700" />
				</Value>
				<Value name="High">
					<Primitive name="Context_Switches" minE="701"
						maxE="*" />
				</Value>
			</MappingFunction>
			<InterpolationFunction>
				<Value name="Low" maxGap="PT1M" />
				<Value name="Normal" maxGap="P30S" />
				<Value name="High" maxGap="P10S" />
			</InterpolationFunction>
		</State>

		<State name="System_Load_level">
			<AbstractedFrom>
				<State name="Garbage_Collections_Level" />
				<State name="Minor_Page_Faults_Level" />
				<State name="Context_Switches_Level" />
			</AbstractedFrom>
			<NecessaryContexts>
				<Context name="High_CPU_Usage" />
			</NecessaryContexts>
			<MappingFunction>
				<Value name="Low">
					<State name="Garbage_Collections_Level" value="Low" />
					<State name="Minor_Page_Faults_Level" value="Low" />
					<State name="Context_Switches_Level" value="Low" />
				</Value>
				<Value name="Normal">
					<State name="Garbage_Collections_Level"
						value="Normal" />
					<State name="Minor_Page_Faults_Level"
						value="Normal" />
					<State name="Context_Switches_Level" value="Normal" />
				</Value>
				<Value name="High">
					<State name="Garbage_Collections_Level"
						value="High" />
					<State name="Minor_Page_Faults_Level" value="High" />
					<State name="Context_Switches_Level" value="High" />
				</Value>
			</MappingFunction>
			<InterpolationFunction>
				<Value name="Low" maxGap="PT1M" />
				<Value name="Normal" maxGap="P30S" />
				<Value name="High" maxGap="P10S" />
			</InterpolationFunction>
		</State>
		
		<State name="Camera_Usage_level">
			<AbstractedFrom>
				<Primitive name="Camera" />
			</AbstractedFrom>
			<NecessaryContexts>
				<Context name="Many_Apps_With_Camera_Permission" />
			</NecessaryContexts>
			<MappingFunction>
				<Value name="Low">
					<Primitive name="Camera" minE="0" maxE="2" />
				</Value>
				<Value name="Normal">
					<Primitive name="Camera" minE="3" maxE="3" />
				</Value>
				<Value name="High">
					<Primitive name="Camera" minE="4" maxE="*" />
				</Value>
			</MappingFunction>
			<InterpolationFunction>
				<Value name="Low" maxGap="PT1M" />
				<Value name="Normal" maxGap="P30S" />
				<Value name="High" maxGap="P10S" />
			</InterpolationFunction>
		</State>
	</States>
	
	<!-- Assumptions: 
		1. the time unit for the treshold is seconds
		2. the angle is in degrees and not radians 
		3. trends are created from primitives (and a single primitive at that)
	-->
	<Trends>
		<Trend name="Network_Usage">
			<AbstractedFrom name="WiFi_TX_Bytes" />
			<NecessaryContexts>
				<Context name="Connected_To_WiFi" />
			</NecessaryContexts>
			<MappingFunction threshold="16" angle="0" maxGap="PT30M" /> 
		</Trend>
	</Trends>
	<!-- 
		assumptions:
		1. the ordinal must be sequential starting with 0
	
	 -->
	<Patterns>
		<LinearPattern name="DDoS Attack">
			<Elements>
	<!--			<Primitive name="CPU_Usage" ordinal="1">
					<NumericValueConditon minE="31" maxE="100" />
					<DurationCondition min="PT0S" max="P8D" />
				</Primitive> -->
				<State name="Garbage_Collections_Level" ordinal="0"> <!-- can be Trend -->
					<SymbolicValueCondition>
						<Value name="High" />
					</SymbolicValueCondition>
					<DurationCondition min="PT1S" max="P8D" />
				</State>
				<Context name="High_CPU_Usage" ordinal="1"> <!-- can be context -->
					<DurationCondition min="PT3S" max="P8D" />
				</Context>
				<Primitive name="CPU_Usage" ordinal="2">
					<NumericValueConditon minE="31" maxE="100" />
					<DurationCondition min="PT0S" max="P8D" />
				</Primitive>
				<Primitive name="CPU_Usage" ordinal="3">
					<NumericValueConditon minE="31" maxE="100" />
					<DurationCondition min="PT0S" max="P8D" />
				</Primitive>
				
			</Elements>
			<PairWiseConditions>
				<PairWiseCondition first="2" second="3" value="*" 
					temporal="Before" minGap="PT1S" maxGap="PT30S" />  
				<PairWiseCondition first="0" second="1" value="*" 
					temporal="Before" minGap="PT1S" maxGap="PT30S" /> 
				<PairWiseCondition first="0" second="3" value="*" 
					temporal="Before" minGap="PT1S" maxGap="PT30S" />
				<PairWiseCondition first="1" second="2" value="*" 
					temporal="Before" minGap="PT1S" maxGap="PT30S" /> 
				<PairWiseCondition first="2" second="0" value="*" 
					temporal="Before" minGap="PT1S" maxGap="PT30S" /> 					
			</PairWiseConditions>
		</LinearPattern>
	</Patterns>
</Ontology>
